Least Squares based Position Estimator for DoA
==================================================
The :math:`\text{5G}^\text{th}` generation of wireless networks are equipped with increased number of antennas and radio
frequency RF chains at the transmitter and receiver. This allows the 5G systems to estimate the angles with improved
resolution. In release-15, 3GPP defined standards to enable methods for estimating UE location based on angle of
departure and angle of arrival measurements for 5G-NR systems. The nomenclature of the methods is detailed below.


.. list-table:: Table-1: Angle od Departure and Arrival based Positioning in 5G Networks
   :widths: 25 25 25 25
   :header-rows: 1

   * - Generation
     - Method
     - Measurement
     - Optimization methods
   * - 5G
     - DL-AoD
     - Beam-ID and RSRP
     - Least Squares, Newton-Raphson, Gradient-Descent
   * - 5G
     - UL-AoA
     - AOA, RToA, Beam-ID, and RSRP
     - Least Squares, Newton-Raphson, Gradient-Descent

Its not possible to find a close form estimator for 2D-DoAs. Hence, DoA based positioning methods rely on iterative
optimization methods. One such optimization method is **Gradient Descent** (GD) which has low complexity iteration in
comparison to **Newton Raphson** (NR) method but needs more iterations to converge to local/global optima. The
comparison between the two methods is shown below:


.. list-table:: Table-2: Performance comparison between Least Squares, Gradient Descent and Newton Raphson algorithm.
   :widths: 25 25 25 25
   :header-rows: 1

   * - Method
     - Computational complexity
     - Convergence
   * - Least Square
     - :math:`\text{N}^2`
     - Fastest
   * - Gradient Descent
     - :math:`N_\text{iterations} \times \text{N}`
     - Slowest
   * - Newton Raphson
     - :math:`N_\text{iterations} \times \text{N}^2`
     - Slow


where N denotes the number of measurements used for positioning and :math:`N_\text{iterations}` denotes the number of
iterations used by iterative methods. The implementation of both these methods provided in 5G
Toolkit is inspired by [3gppDoA]_.

------------

**Code example**

.. code-block:: Python

    # shape of refLocations: Nref x 3
    # shape of xoA: Nref x 2
    posEstimator     = LeastSquareDoA()
    positionEstimate, error = posEstimator(xoA, refLocations)


------------


.. autoclass:: toolkit5G.Positioning.LeastSquareDoA
   :members:
   :exclude-members: call, build


Gradient Descent based Position Estimator for DoA
==================================================

**Code example**

.. code-block:: Python

    # shape of refLocations: Nref x 3
    # shape of xoA: Nref x 2
    numEpoches    = 1
    tolerance     = 10**-5
    numIterations = 10000
    stepsize      = 1

    posEstimator  = GradientDescentDoA(numEpochs = numEpoches, numIterationPerEpoch = numIterations,
                                        stepsize = stepsize, tolerance = tolerance, isd = 100)
    positionEstimate, error = posEstimator(xoA, refLocations)

------------

The input output interface for usage of Gradient Descent algorithm is provided below.

.. autoclass:: toolkit5G.Positioning.GradientDescentDoA
   :members:
   :exclude-members: call, build

------------

References:
    .. [3gppDoA] Y. Wang, Z. Shi, Y. Yu, S. Huang and L. Chen, "Enabling Angle-based Positioning to 3GPP NR Systems," 2019 16th Workshop on Positioning, Navigation and Communications (WPNC), Bremen, Germany, 2019, pp. 1-7, doi: 10.1109/WPNC47567.2019.8970182.
